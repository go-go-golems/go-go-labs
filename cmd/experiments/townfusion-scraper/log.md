# Log 2024/10/2024-10-21

## Reverse engineer City of Providence Recorder of Deeds

- setting the search parameters apparently does:
```
curl 'https://countyfusion10.kofiletech.us/countyweb/search/searchExecute.do?assessor=false' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Content-Type: application/x-www-form-urlencoded' -H 'Origin: https://countyfusion10.kofiletech.us' -H 'Connection: keep-alive' -H 'Referer: https://countyfusion10.kofiletech.us/countyweb/search/dyncriteria/dynCriteria.do?searchType=allNames&searchCategory=ADVANCED' -H 'Cookie: JSESSIONID=018D101634D65A42BB2171EF45931374; lhnStorageType=cookie; lhnStorageType=cookie; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: iframe' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-User: ?1' -H 'Priority: u=4' -H 'TE: trailers' --data-raw 'searchCategory=ADVANCED&searchSessionId=searchJobMain&PLATS=&QUARTER=&SEARCHTYPE=allNames&RECSPERPAGE=200&userRefCode=&INSTTYPEALL=selected&INSTTYPE=&CASETYPE=&ORDERBY_LIST=&DATERANGE=%5B%7B%22name%22%3A%22TODATE%22%2C%22value%22%3A%22User+Defined%22%7D%5D&PARTY=both&REMOVECHARACTERS=true&ALLNAMES=&SELECTEDNAMES=&FROMDATE=&TODATE=&daterange_TODATE=User+Defined&DATA_INDEX_FIELD03=NAMETREE%3ATAX+LIEN%7CVACANT+BLDG+NOTICE%7CVACANT+BLDG+NOTICE+DIS'
```

Getting the search results probably uses the server side session:

```
curl 'https://countyfusion10.kofiletech.us/countyweb/search/TownFusion/docs_SearchResultList.jsp?scrollPos=0&searchSessionId=searchJobMain' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Connection: keep-alive' -H 'Referer: https://countyfusion10.kofiletech.us/countyweb/search/SearchResultsView.jsp?searchSessionId=searchJobMain&scrollToName=null&subNavMenu=search.resultNav.next&navStateDisplay=Displaying+1-200+of+2083+Items&startCursor=0&curSortDirection=asc&curSortColumn=RecordDate&searchSessionId=searchJobMain' -H 'Cookie: JSESSIONID=018D101634D65A42BB2171EF45931374; lhnStorageType=cookie; lhnStorageType=cookie; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: iframe' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Priority: u=4' -H 'TE: trailers'
```

### Second search

Setting the parameters:

```
curl 'https://countyfusion10.kofiletech.us/countyweb/search/searchExecute.do?assessor=false' -X POST -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Content-Type: application/x-www-form-urlencoded' -H 'Origin: https://countyfusion10.kofiletech.us' -H 'Connection: keep-alive' -H 'Referer: https://countyfusion10.kofiletech.us/countyweb/search/dyncriteria/dynCriteria.do?searchType=allNames&searchCategory=ADVANCED' -H 'Cookie: JSESSIONID=018D101634D65A42BB2171EF45931374; lhnStorageType=cookie; lhnStorageType=cookie; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: iframe' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-User: ?1' -H 'Priority: u=4' -H 'TE: trailers' --data-raw 'searchCategory=ADVANCED&searchSessionId=searchJobMain&PLATS=&QUARTER=&SEARCHTYPE=allNames&RECSPERPAGE=200&userRefCode=&INSTTYPEALL=selected&INSTTYPE=&CASETYPE=&ORDERBY_LIST=&DATERANGE=%5B%7B%22name%22%3A%22TODATE%22%2C%22value%22%3A%22User+Defined%22%7D%5D&PARTY=both&REMOVECHARACTERS=true&ALLNAMES=&SELECTEDNAMES=&FROMDATE=&TODATE=&daterange_TODATE=User+Defined&DATA_INDEX_FIELD03=NAMETREE%3A2ND+NOTICE+OF+VIOLATION'
```

Curl with the response:

```
curl 'https://countyfusion10.kofiletech.us/countyweb/search/TownFusion/docs_SearchResultList.jsp?scrollPos=0&searchSessionId=searchJobMain' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Connection: keep-alive' -H 'Referer: https://countyfusion10.kofiletech.us/countyweb/search/SearchResultsView.jsp?searchSessionId=searchJobMain&scrollToName=null&subNavMenu=search.resultNav.next&navStateDisplay=Displaying+1-200+of+11566+Items&startCursor=0&curSortDirection=asc&curSortColumn=RecordDate&searchSessionId=searchJobMain' -H 'Cookie: JSESSIONID=018D101634D65A42BB2171EF45931374; lhnStorageType=cookie; lhnStorageType=cookie; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: iframe' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Priority: u=4' -H 'TE: trailers'
```

Navigating to the next page:

```
curl 'https://countyfusion10.kofiletech.us/countyweb/search/searchResults.do?searchSessionId=searchJobMain&resultPageAction=nav&sortColumn=RecordDate&sortDirection=asc&navDirection=next&startCursor=0&pageNumber=2&2ndTextso_noextrasubmit=&navCBAll=on' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8' -H 'Accept-Language: en-US,en;q=0.5' -H 'Accept-Encoding: gzip, deflate, br, zstd' -H 'Connection: keep-alive' -H 'Referer: https://countyfusion10.kofiletech.us/countyweb/search/SearchResultsView.jsp?searchSessionId=searchJobMain&scrollToName=null&subNavMenu=search.resultNav.next&navStateDisplay=Displaying+1-200+of+11566+Items&startCursor=0&curSortDirection=asc&curSortColumn=RecordDate&searchSessionId=searchJobMain' -H 'Cookie: JSESSIONID=018D101634D65A42BB2171EF45931374; lhnStorageType=cookie; lhnStorageType=cookie; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnJWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJ2aXNpdG9yIiwiZG9tYWluIjoiIiwiZXhwIjoxNzI5NjIzNzQ0LCJpYXQiOjE3Mjk1MzczNDQsImlzcyI6eyJhcHAiOiJqc19zZGsiLCJjbGllbnQiOjI1NjE1LCJjbGllbnRfbGV2ZWwiOiJlbnRlcnByaXNlIiwibGhueF9mZWF0dXJlcyI6W10sInZpc2l0b3JfdHJhY2tpbmciOnRydWV9LCJqdGkiOiJkY2Y3YWU4Yi1lOTkyLTRkMGEtOTdlZi1lZTg2NjJjZmMxMzAiLCJyZXNvdXJjZSI6eyJpZCI6ImRjZjdhZThiLWU5OTItNGQwYS05N2VmLWVlODY2MmNmYzEzMC0yNTYxNS1ydnIxWjBmIiwidHlwZSI6IkVsaXhpci5MaG5EYi5Nb2RlbC5Db3JlLlZpc2l0b3IifX0.P7ae7v4DSJBr_5SAsbxisvzKD0c4ENt-vHOCKz7p8i4; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnRefresh=63477298-4851-4198-9da5-7012c86f8eb7; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f; lhnContact=dcf7ae8b-e992-4d0a-97ef-ee8662cfc130-25615-rvr1Z0f' -H 'Upgrade-Insecure-Requests: 1' -H 'Sec-Fetch-Dest: iframe' -H 'Sec-Fetch-Mode: navigate' -H 'Sec-Fetch-Site: same-origin' -H 'Sec-Fetch-User: ?1' -H 'Priority: u=4'
```

---

## INSTRUCTIONS

The way searching the countyfusion site works is that there is first a request to set the search aprameters, and once that finishes, a request to get the results.

For nwo, hardcore the cookies.

Write a python program that takes flags for the search parametsr and the pagination. If search parameters are given, send them as neede,d otherwise only p aginate.